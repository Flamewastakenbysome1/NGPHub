<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>NGP Hub — Login</title>

<!-- Open Graph / Social Media Preview Tags -->
<meta property="og:title" content="NGP Hub, Convenience. Community. Creation." />
<meta property="og:description" content="NGP builds useful, original stuff, games, tools, and videos, shaped by the community. Join our Discord, play our Roblox games, and explore our tools." />
<meta property="og:image" content="https://ngphub.com/assets/ngp-logo.png" />
<meta property="og:url" content="https://ngphub.com" />
<meta property="og:type" content="website" />
<meta property="og:site_name" content="NGP Hub" />

<!-- Twitter Card Tags -->
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:title" content="NGP Hub, Convenience. Community. Creation." />
<meta name="twitter:description" content="NGP builds useful, original stuff, games, tools, and videos, shaped by the community." />
<meta name="twitter:image" content="https://ngphub.com/assets/ngp-logo.png" />

<!-- Additional SEO -->
<meta name="description" content="NGP builds useful, original stuff, games, tools, and videos, shaped by the community. Join our Discord, play our Roblox games, and explore our tools." />
<meta name="keywords" content="NGP, games, tools, Roblox, Discord, community, development, Yoadverse" />

<!-- Fonts -->
<link href="https://fonts.googleapis.com/css2?family=Rubik:wght@400;500;700&display=swap" rel="stylesheet" />

<!-- Favicon (tab bar icon) -->
<link rel="icon" href="/assets/ngp-logo.png" type="image/png">

<style>
  :root{
    --bg:#0e0e11; --card:#15151b; --ink:#ececf1; --muted:#b5b7c3;
    --brandA:#6a11cb; --brandB:#2575fc; --line:#3a66ff;
    --ring:0 0 0 .2rem rgba(37,117,252,.35);
    --radius:16px; --shadow:0 10px 30px rgba(0,0,0,.35);
  }
  *{box-sizing:border-box}
  html,body{height:100%}
  body{
    margin:0; background:linear-gradient(180deg,#0b0b0e,#121219 60%,#0d0d14);
    color:var(--ink);
    font-family:'Rubik',system-ui,-apple-system,Segoe UI,Roboto,Arial,Helvetica,sans-serif;
    -webkit-font-smoothing:antialiased; text-rendering:optimizeLegibility;
    scroll-behavior:smooth;
  }
  .wrap{max-width:1024px; margin:0 auto; padding:0 16px}
  .hidden{display:none}

  /* Header */
  header{
    position:sticky; top:0; z-index:50; backdrop-filter:saturate(140%) blur(10px);
    background:rgba(10,10,14,.6); border-bottom:1px solid rgba(255,255,255,.06);
  }
  .bar{display:flex; align-items:center; justify-content:space-between; padding:12px 0}
  .logo{display:flex; align-items:center; gap:10px; text-decoration:none; color:var(--ink)}
  .logo-img{width:28px; height:28px; border-radius:10px; object-fit:contain; box-shadow:var(--shadow)}
  .logo h1{font-size:1.05rem; margin:0; letter-spacing:.3px}
  nav{display:flex; align-items:center; gap:6px; flex-wrap:wrap}
  nav a, nav button{
    color:var(--ink); text-decoration:none; font-weight:500; margin-left:0;
    padding:8px 10px; border-radius:10px; opacity:.9; background:none; border:none;
    font-family:inherit; font-size:inherit; cursor:pointer;
  }
  nav a:hover, nav a:focus-visible, nav button:hover, nav button:focus-visible{
    background:rgba(255,255,255,.06); outline:none; box-shadow:var(--ring)
  }

  /* Main Content */
  main{min-height:calc(100vh - 200px); padding:60px 0}
  .user-card{
    background:var(--card); border-radius:var(--radius); padding:32px;
    box-shadow:var(--shadow); text-align:center; max-width:400px; margin:0 auto;
  }
  .user-card img{
    width:100px; height:100px; border-radius:50%; margin-bottom:16px;
    box-shadow:var(--shadow);
  }
  .user-card h2{margin:0 0 8px; font-size:1.5rem}
  .user-card p{color:var(--muted); margin:0 0 24px}
  .btn{
    background:linear-gradient(135deg,var(--brandA),var(--brandB));
    color:white; border:none; padding:12px 28px; border-radius:10px;
    font-weight:600; cursor:pointer; font-size:1rem; box-shadow:var(--shadow);
  }
  .btn:hover{transform:translateY(-2px); box-shadow:0 15px 40px rgba(37,117,252,.4)}

  /* Footer */
  footer{border-top:1px solid rgba(255,255,255,.08); color:var(--muted); padding:24px 0 36px; text-align:center}

  @media (prefers-reduced-motion: reduce){*{transition:none !important; animation:none !important}}
</style>
</head>
<body>

<header>
  <div class="wrap bar">
    <a class="logo" href="/">
      <img src="/assets/ngp-logo.png" alt="NGP Logo" class="logo-img" />
      <h1>NGP</h1>
    </a>
    <nav aria-label="Primary">
      <a href="/tools">Tools</a>
      <a href="/discordservers/">Servers</a>
      <a href="/projects">Projects</a>
      <a href="/docs/">Docs</a>
      <a href="/roblox">Roblox</a>
      <a href="/contact">Contact</a>
      <button id="btn-login" disabled="true">Login</button>
      <button id="btn-logout" disabled="true" class="hidden">Logout</button>
    </nav>
  </div>
</header>

<main>
  <div class="wrap">
    <div id="logged-out-content">
      <div class="user-card">
        <h2>Welcome to NGP Hub</h2>
        <p>Sign in to access your account and unlock all features</p>
        <button class="btn" id="main-login-btn" disabled="true">Sign In</button>
      </div>
    </div>

    <div id="gated-content" class="hidden">
      <div class="user-card">
        <img id="user-avatar" src="" alt="User Avatar" />
        <h2 id="user-name"></h2>
        <p id="user-email"></p>
        <button class="btn" id="main-logout-btn">Sign Out</button>
      </div>
    </div>
  </div>
</main>

<footer>
  <div class="wrap">
    <small>© <span id="year"></span> NGP — Alpha.</small>
  </div>
</footer>

<script src="https://cdn.auth0.com/js/auth0-spa-js/2.0/auth0-spa-js.production.js"></script>
<script>
  document.getElementById('year').textContent = new Date().getFullYear();

  let auth0Client = null;

  const configureClient = async () => {
    auth0Client = await auth0.createAuth0Client({
      domain: 'dev-8lzpwtm5mklzb75m.us.auth0.com',
      clientId: 'eXha4ODZFa68z2aXOD7Ki6t1MZJhVONh'
    });
  };

  const updateUI = async () => {
    const isAuthenticated = await auth0Client.isAuthenticated();
    
    document.getElementById("btn-logout").disabled = !isAuthenticated;
    document.getElementById("btn-login").disabled = isAuthenticated;
    document.getElementById("main-login-btn").disabled = isAuthenticated;
    
    if (isAuthenticated) {
      document.getElementById("btn-logout").classList.remove("hidden");
      document.getElementById("btn-login").classList.add("hidden");
      document.getElementById("gated-content").classList.remove("hidden");
      document.getElementById("logged-out-content").classList.add("hidden");
      
      const user = await auth0Client.getUser();
      console.log('User profile:', user);
      
      document.getElementById('user-avatar').src = user.picture;
      document.getElementById('user-name').textContent = user.name;
      document.getElementById('user-email').textContent = user.email;
    } else {
      document.getElementById("btn-logout").classList.add("hidden");
      document.getElementById("btn-login").classList.remove("hidden");
      document.getElementById("gated-content").classList.add("hidden");
      document.getElementById("logged-out-content").classList.remove("hidden");
    }
  };

  const login = async () => {
    await auth0Client.loginWithRedirect({
      authorizationParams: {
        redirect_uri: window.location.origin
      }
    });
  };

  const logout = () => {
    auth0Client.logout({
      logoutParams: {
        returnTo: window.location.origin
      }
    });
  };

  window.onload = async () => {
    await configureClient();
    
    updateUI();
    
    const isAuthenticated = await auth0Client.isAuthenticated();
    
    if (isAuthenticated) {
      console.log("User is already authenticated");
      return;
    }
    
    const query = window.location.search;
    if (query.includes("code=") && query.includes("state=")) {
      await auth0Client.handleRedirectCallback();
      updateUI();
      window.history.replaceState({}, document.title, "/");
    }
  };

  // Event listeners
  document.addEventListener('DOMContentLoaded', () => {
    document.getElementById('btn-login').addEventListener('click', login);
    document.getElementById('main-login-btn').addEventListener('click', login);
    document.getElementById('btn-logout').addEventListener('click', logout);
    document.getElementById('main-logout-btn').addEventListener('click', logout);
  });
</script>
</body>
</html>
