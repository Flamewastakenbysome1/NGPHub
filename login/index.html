<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>NGP Hub â€” Login</title>

<link href="https://fonts.googleapis.com/css2?family=Rubik:wght@400;500;700&display=swap" rel="stylesheet" />
<link rel="icon" href="/assets/ngp-logo.png" type="image/png">

<!-- reCAPTCHA -->
<script src="https://www.google.com/recaptcha/api.js" async defer></script>

<style>
  :root{
    --bg:#0e0e11; --card:#15151b; --ink:#ececf1; --muted:#b5b7c3;
    --brandA:#6a11cb; --brandB:#2575fc; --line:#3a66ff;
    --ring:0 0 0 .2rem rgba(37,117,252,.35);
    --radius:16px; --shadow:0 10px 30px rgba(0,0,0,.35);
  }
  *{box-sizing:border-box}
  html,body{height:100%}
  body{
    margin:0; background:linear-gradient(180deg,#0b0b0e,#121219 60%,#0d0d14);
    color:var(--ink);
    font-family:'Rubik',system-ui,-apple-system,Segoe UI,Roboto,Arial,Helvetica,sans-serif;
    -webkit-font-smoothing:antialiased; text-rendering:optimizeLegibility;
    display:flex; align-items:center; justify-content:center;
  }
  .wrap{max-width:1024px; margin:0 auto; padding:0 16px}

  /* Header */
  header{
    position:fixed; top:0; left:0; right:0; z-index:50; backdrop-filter:saturate(140%) blur(10px);
    background:rgba(10,10,14,.6); border-bottom:1px solid rgba(255,255,255,.06);
  }
  .bar{display:flex; align-items:center; justify-content:space-between; padding:12px 0}
  .logo{display:flex; align-items:center; gap:10px; text-decoration:none; color:var(--ink)}
  .logo-img{width:28px; height:28px; border-radius:10px; object-fit:contain; box-shadow:var(--shadow)}
  .logo h1{font-size:1.05rem; margin:0; letter-spacing:.3px}
  nav{display:flex; align-items:center; gap:6px; flex-wrap:wrap}
  nav a{
    color:var(--ink); text-decoration:none; font-weight:500;
    padding:8px 10px; border-radius:10px; opacity:.9
  }
  nav a:hover{background:rgba(255,255,255,.06)}

  /* Login Card */
  .login-card{
    background:var(--card); border-radius:var(--radius); padding:40px;
    box-shadow:var(--shadow); max-width:420px; width:100%; margin-top:80px;
  }
  .login-card h2{margin:0 0 8px; font-size:1.8rem; background:linear-gradient(135deg,var(--brandA),var(--brandB)); -webkit-background-clip:text; -webkit-text-fill-color:transparent}
  .login-card p{color:var(--muted); margin:0 0 32px}
  
  .input-group{margin-bottom:20px}
  .input-group label{display:block; margin-bottom:8px; font-weight:500; font-size:.9rem}
  .input-group input{
    width:100%; padding:12px 16px; border-radius:10px; border:1px solid rgba(255,255,255,.1);
    background:rgba(255,255,255,.03); color:var(--ink); font-family:inherit; font-size:1rem;
    transition:all .2s;
  }
  .input-group input:focus{outline:none; border-color:var(--brandB); box-shadow:var(--ring)}
  
  .btn{
    width:100%; padding:14px; border:none; border-radius:10px; font-weight:600; font-size:1rem;
    background:linear-gradient(135deg,var(--brandA),var(--brandB)); color:#fff; cursor:pointer;
    transition:transform .2s, box-shadow .2s; font-family:inherit;
  }
  .btn:hover{transform:translateY(-2px); box-shadow:0 8px 20px rgba(106,17,203,.4)}
  .btn:active{transform:translateY(0)}
  .btn:disabled{opacity:0.6; cursor:not-allowed; transform:none}
  
  .toggle{text-align:center; margin-top:20px; color:var(--muted); font-size:.9rem}
  .toggle a{color:var(--brandB); text-decoration:none; font-weight:500}
  .toggle a:hover{text-decoration:underline}
  
  .error{background:rgba(255,50,50,.1); border:1px solid rgba(255,50,50,.3); color:#ff6b6b;
    padding:12px; border-radius:8px; margin-bottom:20px; font-size:.9rem}
  .success{background:rgba(50,255,100,.1); border:1px solid rgba(50,255,100,.3); color:#51cf66;
    padding:12px; border-radius:8px; margin-bottom:20px; font-size:.9rem}
</style>
</head>
<body>

<header>
  <div class="wrap bar">
    <a class="logo" href="/">
      <img src="/assets/ngp-logo.png" alt="NGP Logo" class="logo-img" />
      <h1>NGP</h1>
    </a>
    <nav>
      <a href="/tools">Tools</a>
      <a href="/discordservers/">Servers</a>
      <a href="/projects">Projects</a>
      <a href="/docs/">Docs</a>
      <a href="/roblox">Roblox</a>
      <a href="/contact">Contact</a>
    </nav>
  </div>
</header>

<div class="login-card">
  <h2 id="form-title">Login to NGP</h2>
  <p id="form-subtitle">Access your saved data and projects</p>
  
  <div id="message"></div>
  
  <form id="auth-form">
    <div class="input-group">
      <label for="email">Email</label>
      <input type="email" id="email" placeholder="your@email.com" required />
    </div>
    
    <div class="input-group">
      <label for="password">Password</label>
      <input type="password" id="password" placeholder="â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢" required />
    </div>
    
    <!-- reCAPTCHA -->
    <div class="g-recaptcha" data-sitekey="6Ldwe_MrAAAAAEPzAdosFogNEPUS_ELrZvsrVkl9" style="margin-bottom: 20px; display: flex; justify-content: center;"></div>
    
    <button type="submit" class="btn" id="submit-btn">Login</button>
  </form>
  
  <div class="toggle">
    <span id="toggle-text">Don't have an account?</span>
    <a href="#" id="toggle-link">Sign up</a>
  </div>
</div>

<!-- Firebase SDK -->
<script type="module">
  // Import Firebase
  import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js';
  import { getAuth, createUserWithEmailAndPassword, signInWithEmailAndPassword, sendEmailVerification } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js';

  // ðŸ”¥ YOUR FIREBASE CONFIG ðŸ”¥
  const firebaseConfig = {
    apiKey: "AIzaSyASMd5kEAscaERvWAT6rYmZSahP2NFW0E0",
    authDomain: "ngp-hub.firebaseapp.com",
    projectId: "ngp-hub",
    storageBucket: "ngp-hub.firebasestorage.app",
    messagingSenderId: "157947384705",
    appId: "1:157947384705:web:c89e95d6d9f7436bb5ce80"
  };

  // Initialize Firebase
  const app = initializeApp(firebaseConfig);
  const auth = getAuth(app);

  // Elements
  const form = document.getElementById('auth-form');
  const emailInput = document.getElementById('email');
  const passwordInput = document.getElementById('password');
  const submitBtn = document.getElementById('submit-btn');
  const toggleLink = document.getElementById('toggle-link');
  const formTitle = document.getElementById('form-title');
  const formSubtitle = document.getElementById('form-subtitle');
  const toggleText = document.getElementById('toggle-text');
  const messageDiv = document.getElementById('message');

  let isLoginMode = true;

  // Toggle between login and signup
  toggleLink.addEventListener('click', (e) => {
    e.preventDefault();
    isLoginMode = !isLoginMode;
    
    if (isLoginMode) {
      formTitle.textContent = 'Login to NGP';
      formSubtitle.textContent = 'Access your saved data and projects';
      submitBtn.textContent = 'Login';
      toggleText.textContent = "Don't have an account?";
      toggleLink.textContent = 'Sign up';
    } else {
      formTitle.textContent = 'Join NGP Hub';
      formSubtitle.textContent = 'Create your account and save your progress';
      submitBtn.textContent = 'Sign Up';
      toggleText.textContent = 'Already have an account?';
      toggleLink.textContent = 'Login';
    }
    messageDiv.innerHTML = '';
  });

  // Handle form submission
  form.addEventListener('submit', async (e) => {
    e.preventDefault();
    
    // Check reCAPTCHA
    const recaptchaResponse = grecaptcha.getResponse();
    if (!recaptchaResponse) {
      showMessage('Please complete the reCAPTCHA', 'error');
      return;
    }
    
    const email = emailInput.value.trim();
    const password = passwordInput.value;

    if (password.length < 6) {
      showMessage('Password must be at least 6 characters', 'error');
      return;
    }

    submitBtn.disabled = true;
    submitBtn.textContent = 'Loading...';

    try {
      if (isLoginMode) {
        // Login
        const userCredential = await signInWithEmailAndPassword(auth, email, password);
        
        // Check if email is verified
        if (!userCredential.user.emailVerified) {
          showMessage('Please verify your email before logging in. Check your inbox!', 'error');
          submitBtn.disabled = false;
          submitBtn.textContent = 'Login';
          return;
        }
        
        showMessage('Login successful! Redirecting...', 'success');
        
        // Save user ID to localStorage
        localStorage.setItem('ngp_user_id', userCredential.user.uid);
        localStorage.setItem('ngp_user_email', userCredential.user.email);
        
        // Redirect to home after 1 second
        setTimeout(() => {
          window.location.href = '/';
        }, 1000);
        
      } else {
        // Sign up
        const userCredential = await createUserWithEmailAndPassword(auth, email, password);
        
        // Send email verification
        await sendEmailVerification(userCredential.user);
        
        showMessage('Account created! Please check your email (including spam folder) to verify your account before logging in.', 'success');
        
        // Don't log them in yet, make them verify first
        submitBtn.disabled = false;
        submitBtn.textContent = 'Sign Up';
        
        // Switch to login mode after 3 seconds
        setTimeout(() => {
          isLoginMode = true;
          formTitle.textContent = 'Login to NGP';
          formSubtitle.textContent = 'Access your saved data and projects';
          submitBtn.textContent = 'Login';
          toggleText.textContent = "Don't have an account?";
          toggleLink.textContent = 'Sign up';
          messageDiv.innerHTML = '';
          emailInput.value = email; // Keep the email filled in
          passwordInput.value = '';
        }, 3000);
      }
    } catch (error) {
      console.error('Auth error:', error);
      
      // User-friendly error messages
      let errorMessage = 'Something went wrong. Please try again.';
      if (error.code === 'auth/email-already-in-use') {
        errorMessage = 'This email is already registered. Try logging in instead.';
      } else if (error.code === 'auth/invalid-email') {
        errorMessage = 'Invalid email address.';
      } else if (error.code === 'auth/wrong-password' || error.code === 'auth/invalid-credential') {
        errorMessage = 'Wrong email or password.';
      } else if (error.code === 'auth/user-not-found') {
        errorMessage = 'No account found with this email.';
      } else if (error.code === 'auth/weak-password') {
        errorMessage = 'Password is too weak. Use at least 6 characters.';
      }
      
      showMessage(errorMessage, 'error');
      submitBtn.disabled = false;
      submitBtn.textContent = isLoginMode ? 'Login' : 'Sign Up';
      
      // Reset reCAPTCHA
      grecaptcha.reset();
    }
  });

  function showMessage(text, type) {
    messageDiv.className = type;
    messageDiv.textContent = text;
  }
</script>

</body>
</html>
