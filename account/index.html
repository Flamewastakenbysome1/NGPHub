<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>My Account ‚Äî NGP Hub</title>

<link href="https://fonts.googleapis.com/css2?family=Rubik:wght@400;500;700&display=swap" rel="stylesheet" />
<link rel="icon" href="/assets/ngp-logo.png" type="image/png">

<style>
  :root{
    --bg:#0e0e11; --card:#15151b; --ink:#ececf1; --muted:#b5b7c3;
    --brandA:#6a11cb; --brandB:#2575fc;
    --ring:0 0 0 .2rem rgba(37,117,252,.35);
    --radius:16px; --shadow:0 10px 30px rgba(0,0,0,.35);
  }
  *{box-sizing:border-box}
  html,body{height:100%; margin:0}
  body{
    background:linear-gradient(180deg,#0b0b0e,#121219 60%,#0d0d14);
    color:var(--ink);
    font-family:'Rubik',system-ui,-apple-system,Segoe UI,Roboto,Arial,Helvetica,sans-serif;
    -webkit-font-smoothing:antialiased; text-rendering:optimizeLegibility;
  }
  .wrap{max-width:900px; margin:0 auto; padding:40px 16px}

  /* Header */
  header{
    position:sticky; top:0; z-index:50; backdrop-filter:saturate(140%) blur(10px);
    background:rgba(10,10,14,.6); border-bottom:1px solid rgba(255,255,255,.06);
  }
  .bar{display:flex; align-items:center; justify-content:space-between; padding:12px 0; max-width:1024px; margin:0 auto; padding-left:16px; padding-right:16px}
  .logo{display:flex; align-items:center; gap:10px; text-decoration:none; color:var(--ink)}
  .logo-img{width:28px; height:28px; border-radius:10px; object-fit:contain; box-shadow:var(--shadow)}
  .logo h1{font-size:1.05rem; margin:0; letter-spacing:.3px}
  nav{display:flex; align-items:center; gap:6px; flex-wrap:wrap}
  nav a{
    color:var(--ink); text-decoration:none; font-weight:500;
    padding:8px 10px; border-radius:10px; opacity:.9
  }
  nav a:hover{background:rgba(255,255,255,.06)}

  /* Welcome Section */
  .welcome{
    text-align:center; padding:40px 0 30px;
    background:radial-gradient(800px 400px at 50% -20%, rgba(106,17,203,.2), transparent 70%);
    border-radius:var(--radius); margin-bottom:32px;
  }
  .welcome h2{
    font-size:2.5rem; margin:0 0 8px;
    background:linear-gradient(135deg, var(--brandA), var(--brandB));
    -webkit-background-clip:text; background-clip:text;
    -webkit-text-fill-color:transparent;
  }
  .welcome-email{color:var(--muted); font-size:1.1rem; margin:0}
  .welcome-status{
    display:inline-block; margin-top:12px; padding:6px 16px; border-radius:20px;
    font-size:.9rem; font-weight:600;
  }
  .welcome-status.verified{background:rgba(76,175,80,.15); color:#4caf50; border:1px solid rgba(76,175,80,.3)}
  .welcome-status.unverified{background:rgba(255,165,0,.15); color:#ffa500; border:1px solid rgba(255,165,0,.3)}

  /* Grid */
  .grid{display:grid; grid-template-columns:repeat(auto-fit, minmax(280px, 1fr)); gap:20px; margin-bottom:32px}

  /* Card */
  .card{
    background:var(--card); border-radius:var(--radius); padding:24px;
    box-shadow:var(--shadow); border:1px solid rgba(255,255,255,.06);
    transition:transform .2s ease, border-color .2s ease;
  }
  .card:hover{transform:translateY(-3px); border-color:rgba(37,117,252,.35)}
  .card-icon{font-size:2rem; margin-bottom:12px}
  .card h3{margin:0 0 8px; font-size:1.1rem}
  .card p{color:var(--muted); margin:0 0 16px; line-height:1.5; font-size:.95rem}
  .card a{
    display:inline-block; padding:8px 16px; border-radius:8px;
    background:linear-gradient(135deg, var(--brandA), var(--brandB));
    color:white; text-decoration:none; font-weight:600; font-size:.9rem;
    transition:transform .2s ease;
  }
  .card a:hover{transform:scale(1.05)}

  /* Quick Stats */
  .stats{
    background:var(--card); border-radius:var(--radius); padding:24px;
    box-shadow:var(--shadow); border:1px solid rgba(255,255,255,.06);
    margin-bottom:32px;
  }
  .stats h3{margin:0 0 16px; font-size:1.2rem}
  .stats-grid{display:grid; grid-template-columns:repeat(auto-fit, minmax(200px, 1fr)); gap:16px}
  .stat-item{
    background:rgba(255,255,255,.03); border-radius:10px; padding:16px;
    border:1px solid rgba(255,255,255,.06);
  }
  .stat-label{color:var(--muted); font-size:.85rem; margin:0 0 4px}
  .stat-value{font-size:1.4rem; font-weight:700; margin:0}

  /* Subscription Info */
  .sub-card{
    background:linear-gradient(135deg, rgba(106,17,203,.15), rgba(37,117,252,.15));
    border:2px solid rgba(37,117,252,.3);
    border-radius:var(--radius); padding:24px;
    margin-bottom:32px;
  }
  .sub-card h3{margin:0 0 8px; font-size:1.2rem}
  .sub-card p{color:var(--muted); margin:0 0 16px}
  .sub-card .tier{
    display:inline-block; padding:8px 16px; border-radius:8px;
    background:rgba(255,255,255,.1); font-weight:600; margin-bottom:12px;
  }

  /* Modal */
  .modal{
    display:none; position:fixed; top:0; left:0; width:100%; height:100%;
    background:rgba(0,0,0,.8); backdrop-filter:blur(5px);
    z-index:1000; align-items:center; justify-content:center;
  }
  .modal.active{display:flex}
  .modal-content{
    background:var(--card); border-radius:var(--radius); max-width:450px; width:90%;
    box-shadow:0 20px 60px rgba(0,0,0,.5); border:1px solid rgba(255,255,255,.1);
    animation:modalSlideIn 0.3s ease-out;
  }
  @keyframes modalSlideIn{
    from{transform:translateY(-50px); opacity:0}
    to{transform:translateY(0); opacity:1}
  }
  .modal-header{
    padding:20px 24px; border-bottom:1px solid rgba(255,255,255,.06);
  }
  .modal-header h3{margin:0; font-size:1.2rem}
  .modal-body{padding:24px; line-height:1.6}
  .modal-body p{margin:0}
  .modal-footer{
    padding:16px 24px; border-top:1px solid rgba(255,255,255,.06);
    display:flex; gap:12px; justify-content:flex-end;
  }

  @media (max-width: 768px){
    .welcome h2{font-size:2rem}
    .stats-grid{grid-template-columns:1fr}
    .modal-content{width:95%}
    .modal-footer{flex-direction:column}
    .modal-footer .btn{width:100%}
  }
</style>
</head>
<body>

<header>
  <div class="bar">
    <a class="logo" href="/">
      <img src="/assets/ngp-logo.png" alt="NGP Logo" class="logo-img" />
      <h1>NGP</h1>
    </a>
    <nav>
      <a href="/">Home</a>
      <a href="/tools">Tools</a>
      <a href="/account/settings">Settings</a>
      <a href="#" id="logout-link">Logout</a>
    </nav>
  </div>
</header>

<main class="wrap">
  <!-- Welcome Section -->
  <section class="welcome">
    <h2 id="welcome-name">Welcome back!</h2>
    <p class="welcome-email" id="user-email">Loading...</p>
    <span class="welcome-status" id="verification-status">Loading...</span>
  </section>

  <!-- Quick Stats -->
  <div class="stats">
    <h3>Account Overview</h3>
    <div class="stats-grid">
      <div class="stat-item">
        <p class="stat-label">Account Created</p>
        <p class="stat-value" id="account-age">Loading...</p>
      </div>
      <div class="stat-item">
        <p class="stat-label">Last Login</p>
        <p class="stat-value" id="last-login">Loading...</p>
      </div>
      <div class="stat-item">
        <p class="stat-label">Account Status</p>
        <p class="stat-value" id="account-status">Active</p>
      </div>
    </div>
  </div>

  <!-- Quick Actions -->
  <div class="grid">
    <div class="card">
      <div class="card-icon">‚öôÔ∏è</div>
      <h3>Account Settings</h3>
      <p>Manage your account details, security, and preferences</p>
      <a href="/account/settings">Go to Settings</a>
    </div>

    <div class="card">
      <div class="card-icon">üìä</div>
      <h3>Export Data</h3>
      <p>Download all your account data in JSON format</p>
      <a href="/account/settings">Export Data</a>
    </div>

    <div class="card">
      <div class="card-icon">üîí</div>
      <h3>Privacy & Security</h3>
      <p>Review our privacy policy and security practices</p>
      <a href="/privacy">View Privacy Policy</a>
    </div>
  </div>
</main>

<!-- Logout Confirmation Modal -->
<div id="logout-modal" class="modal">
  <div class="modal-content" style="border-color:rgba(255,255,255,.1)">
    <div class="modal-header" style="border-bottom-color:rgba(255,255,255,.06)">
      <h3 style="color:var(--ink)">Logout from NGP Hub?</h3>
    </div>
    <div class="modal-body">
      <p>Are you sure you want to logout?</p>
    </div>
    <div class="modal-footer">
      <button class="btn btn-ghost" id="cancel-logout-btn">Cancel</button>
      <button class="btn btn-primary" id="confirm-logout-btn">Logout</button>
    </div>
  </div>
</div>

<script type="module">
  import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js';
  import { getAuth, onAuthStateChanged, signOut } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js';

  const firebaseConfig = {
    apiKey: "AIzaSyASMd5kEAscaERvWAT6rYmZSahP2NFW0E0",
    authDomain: "ngp-hub.firebaseapp.com",
    projectId: "ngp-hub",
    storageBucket: "ngp-hub.firebasestorage.app",
    messagingSenderId: "157947384705",
    appId: "1:157947384705:web:c89e95d6d9f7436bb5ce80"
  };

  const app = initializeApp(firebaseConfig);
  const auth = getAuth(app);

  // Check if user is logged in
  onAuthStateChanged(auth, (user) => {
    if (!user) {
      // Not logged in, redirect to login
      window.location.href = '/login';
      return;
    }

    // Display user info
    const emailName = user.email.split('@')[0];
    document.getElementById('welcome-name').textContent = `Welcome back, ${emailName}!`;
    document.getElementById('user-email').textContent = user.email;

    // Verification status
    const statusEl = document.getElementById('verification-status');
    if (user.emailVerified) {
      statusEl.textContent = '‚úÖ Email Verified';
      statusEl.className = 'welcome-status verified';
    } else {
      statusEl.textContent = '‚ö†Ô∏è Email Not Verified';
      statusEl.className = 'welcome-status unverified';
    }

    // Account age
    const createdDate = new Date(user.metadata.creationTime);
    const now = new Date();
    const daysSince = Math.floor((now - createdDate) / (1000 * 60 * 60 * 24));
    document.getElementById('account-age').textContent = daysSince === 0 ? 'Today' : `${daysSince} days ago`;

    // Last login
    const lastLogin = new Date(user.metadata.lastSignInTime);
    const hoursSince = Math.floor((now - lastLogin) / (1000 * 60 * 60));
    if (hoursSince === 0) {
      document.getElementById('last-login').textContent = 'Just now';
    } else if (hoursSince < 24) {
      document.getElementById('last-login').textContent = `${hoursSince}h ago`;
    } else {
      document.getElementById('last-login').textContent = `${Math.floor(hoursSince / 24)}d ago`;
    }
  });

  // Logout
  const logoutLink = document.getElementById('logout-link');
  const logoutModal = document.getElementById('logout-modal');
  const confirmLogoutBtn = document.getElementById('confirm-logout-btn');
  const cancelLogoutBtn = document.getElementById('cancel-logout-btn');

  logoutLink.addEventListener('click', (e) => {
    e.preventDefault();
    logoutModal.classList.add('active');
  });

  cancelLogoutBtn.addEventListener('click', () => {
    logoutModal.classList.remove('active');
  });

  confirmLogoutBtn.addEventListener('click', async () => {
    await signOut(auth);
    localStorage.removeItem('ngp_user_id');
    localStorage.removeItem('ngp_user_email');
    window.location.href = '/';
  });
</script>

<script src="/ngp-consent.js"></script>

</body>
</html>
